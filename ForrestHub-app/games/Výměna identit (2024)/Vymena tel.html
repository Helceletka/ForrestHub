{% extends "templates/base.html" %}
{% set game_name = "Po≈ôadov√© ƒç√≠slo a ƒças" %}
{% block content %}
    <style>
        .game {
            padding-top: 100px;
        }
        .input-code {
            width: 60px;
            height: 60px;
            font-size: 2em;
            text-align: center;
            margin: 0 10px;
            text-transform: uppercase;
        }
        .message {
            margin-top: 20px;
            font-size: 1.5em;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
    </style>

    <div class="container text-center game">
        <h1 class="mb-4">Zadej p≈ô√≠stupov√Ω k√≥d:</h1>
        <div class="d-flex justify-content-center">
            <input type="text" class="input-code form-control" id="code1" maxlength="1" autofocus>
            <input type="text" class="input-code form-control" id="code2" maxlength="1">
            <input type="text" class="input-code form-control" id="code3" maxlength="1">
            <input type="text" class="input-code form-control" id="code4" maxlength="1">
        </div>
        <div class="message" id="message"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input[type="text"]');
            const message = document.getElementById('message');
            const codeMap = {
                "WRIO": "A1", "QTYI": "A2", "EYIP": "A3", "QRTO": "A4", "QYIO": "A5",
                "SDFJ": "B1", "ASGZ": "B2", "FHJL": "B3", "ADKZ": "B4", "SGHK": "B5",
                "XCNR": "C1", "ZCVE": "C2", "BMER": "C3", "VNMW": "C4", "ZVWR": "C5",
                "IUQW": "D1", "UREQ": "D2", "PRQW": "D3", "OUEQ": "D4", "PYTE": "D5",
                "BXLJ": "E1", "MVCK": "E2", "MXLK": "E3", "NBVZ": "E4", "MNCJ": "E5",
                "SFGQ": "F1", "LJHW": "F2", "KDFH": "F3", "KJFW": "F4", "LJSQ": "F5",
                "ERTG": "G1", "SDRF": "G2", "QSFG": "G3", "WSTG": "G4", "SRFT": "G5",
                "PUYG": "H1", "LKHY": "H2", "PIJH": "H3", "OJHG": "H4", "PKIY": "H5",
                "MYRE": "J1", "NBGT": "J2", "MNHD": "J3", "GYTE": "J4", "MBRD": "J5",
                "ASXD": "K1", "AZXR": "K2", "QZWC": "K3", "SECR": "K4", "WXED": "K5"
            };

            // P≈ôid√°n√≠ event listeneru pro prvn√≠ znak
            inputs.forEach((input) => {
                input.addEventListener('input', function() {
                    if (input.value.length === 1 && message.textContent !== "Zad√°n√≠ potvrƒè kl√°vesou Enter.") {
                        updateMessageOnInput();
                    }
                });
            });

            inputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    if (input.value.length === 1) {
                        if (index < inputs.length - 1) {
                            inputs[index + 1].focus();
                        } else {
                            input.blur();
                        }
                    }
                });

                input.addEventListener('keydown', function(event) {
                    if (event.key === 'Backspace') {
                        if (input.value === '' && index > 0) {
                            inputs[index - 1].focus();
                        } else {
                            input.value = ''; // Sma≈æe aktu√°ln√≠ znak
                        }
                    }
                });
            });

            document.addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    checkCode();
                }
            });

            function updateMessageOnInput() {
                message.textContent = "Zad√°n√≠ potvrƒè kl√°vesou Enter.";
                message.className = "message";
            }

            function checkCode() {
                const code = Array.from(inputs).map(input => input.value.trim().toUpperCase()).join('');
                const key = codeMap[code];

                if (key) {
                    message.innerHTML = `‚úÖ K√≥d je spr√°vn√Ω. Otev≈ôi dve≈ôe ${key}.`;
                    message.className = "message correct";
                } else {
                    message.textContent = `üõë Nespr√°vn√Ω k√≥d.`;
                    message.className = "message incorrect";
                }

                clearForm();
            }

            function clearForm() {
                setTimeout(() => {
                    inputs.forEach(input => input.value = '');
                    inputs[0].focus();
                }, 500);
            }
        });
    </script>

{% endblock %}
